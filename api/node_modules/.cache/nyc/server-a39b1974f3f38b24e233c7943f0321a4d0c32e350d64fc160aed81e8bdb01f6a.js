function cov_3ydeex10c(){var path="/home/adrian/Work/NodeJsTutorials/TDD/nesm/server.js";var hash="a107a324766733d17db4ac3daff69c88eae203d2";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/adrian/Work/NodeJsTutorials/TDD/nesm/server.js",statementMap:{"0":{start:{line:2,column:16},end:{line:2,column:34}},"1":{start:{line:4,column:13},end:{line:4,column:28}},"2":{start:{line:5,column:12},end:{line:5,column:35}},"3":{start:{line:6,column:14},end:{line:6,column:57}},"4":{start:{line:7,column:15},end:{line:7,column:32}},"5":{start:{line:9,column:17},end:{line:9,column:36}},"6":{start:{line:10,column:20},end:{line:10,column:43}},"7":{start:{line:12,column:17},end:{line:12,column:39}},"8":{start:{line:13,column:18},end:{line:13,column:38}},"9":{start:{line:15,column:17},end:{line:15,column:19}},"10":{start:{line:16,column:0},end:{line:16,column:69}},"11":{start:{line:17,column:0},end:{line:17,column:34}},"12":{start:{line:20,column:15},end:{line:29,column:2}},"13":{start:{line:21,column:4},end:{line:21,column:49}},"14":{start:{line:22,column:15},end:{line:22,column:52}},"15":{start:{line:24,column:4},end:{line:28,column:5}},"16":{start:{line:25,column:8},end:{line:25,column:25}},"17":{start:{line:27,column:8},end:{line:27,column:26}},"18":{start:{line:31,column:0},end:{line:31,column:23}},"19":{start:{line:33,column:12},end:{line:33,column:21}},"20":{start:{line:35,column:18},end:{line:37,column:1}},"21":{start:{line:38,column:0},end:{line:38,column:31}},"22":{start:{line:41,column:0},end:{line:41,column:27}},"23":{start:{line:44,column:0},end:{line:44,column:24}},"24":{start:{line:47,column:0},end:{line:47,column:48}},"25":{start:{line:49,column:11},end:{line:49,column:30}},"26":{start:{line:51,column:0},end:{line:51,column:20}},"27":{start:{line:59,column:0},end:{line:70,column:3}},"28":{start:{line:60,column:31},end:{line:60,column:39}},"29":{start:{line:61,column:23},end:{line:61,column:25}},"30":{start:{line:67,column:4},end:{line:69,column:6}},"31":{start:{line:68,column:8},end:{line:68,column:63}},"32":{start:{line:73,column:0},end:{line:93,column:3}},"33":{start:{line:74,column:31},end:{line:74,column:39}},"34":{start:{line:75,column:4},end:{line:92,column:5}},"35":{start:{line:76,column:19},end:{line:76,column:54}},"36":{start:{line:77,column:8},end:{line:79,column:9}},"37":{start:{line:78,column:12},end:{line:78,column:68}},"38":{start:{line:81,column:8},end:{line:89,column:9}},"39":{start:{line:84,column:26},end:{line:84,column:41}},"40":{start:{line:85,column:24},end:{line:85,column:65}},"41":{start:{line:86,column:12},end:{line:86,column:50}},"42":{start:{line:88,column:12},end:{line:88,column:67}},"43":{start:{line:99,column:0},end:{line:99,column:91}},"44":{start:{line:100,column:0},end:{line:100,column:37}},"45":{start:{line:101,column:0},end:{line:101,column:90}},"46":{start:{line:105,column:13},end:{line:105,column:37}},"47":{start:{line:107,column:0},end:{line:109,column:3}},"48":{start:{line:108,column:4},end:{line:108,column:54}},"49":{start:{line:111,column:0},end:{line:111,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:20,column:43},end:{line:20,column:44}},loc:{start:{line:20,column:72},end:{line:29,column:1}},line:20},"1":{name:"(anonymous_1)",decl:{start:{line:59,column:22},end:{line:59,column:23}},loc:{start:{line:59,column:48},end:{line:70,column:1}},line:59},"2":{name:"(anonymous_2)",decl:{start:{line:67,column:46},end:{line:67,column:47}},loc:{start:{line:68,column:8},end:{line:68,column:63}},line:68},"3":{name:"(anonymous_3)",decl:{start:{line:73,column:19},end:{line:73,column:20}},loc:{start:{line:73,column:51},end:{line:93,column:1}},line:73},"4":{name:"(anonymous_4)",decl:{start:{line:107,column:17},end:{line:107,column:18}},loc:{start:{line:107,column:23},end:{line:109,column:1}},line:107}},branchMap:{"0":{loc:{start:{line:24,column:4},end:{line:28,column:5}},type:"if",locations:[{start:{line:24,column:4},end:{line:28,column:5}},{start:{line:24,column:4},end:{line:28,column:5}}],line:24},"1":{loc:{start:{line:75,column:4},end:{line:92,column:5}},type:"if",locations:[{start:{line:75,column:4},end:{line:92,column:5}},{start:{line:75,column:4},end:{line:92,column:5}}],line:75},"2":{loc:{start:{line:75,column:8},end:{line:75,column:24}},type:"binary-expr",locations:[{start:{line:75,column:8},end:{line:75,column:12}},{start:{line:75,column:16},end:{line:75,column:24}}],line:75},"3":{loc:{start:{line:77,column:8},end:{line:79,column:9}},type:"if",locations:[{start:{line:77,column:8},end:{line:79,column:9}},{start:{line:77,column:8},end:{line:79,column:9}}],line:77},"4":{loc:{start:{line:81,column:8},end:{line:89,column:9}},type:"if",locations:[{start:{line:81,column:8},end:{line:89,column:9}},{start:{line:81,column:8},end:{line:89,column:9}}],line:81},"5":{loc:{start:{line:105,column:13},end:{line:105,column:37}},type:"binary-expr",locations:[{start:{line:105,column:13},end:{line:105,column:29}},{start:{line:105,column:33},end:{line:105,column:37}}],line:105}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"a107a324766733d17db4ac3daff69c88eae203d2"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_3ydeex10c=function(){return actualCoverage;};}return actualCoverage;}cov_3ydeex10c();const express=(cov_3ydeex10c().s[0]++,require("express"));// const bodyParser = require("body-parser"); /* deprecated */
const cors=(cov_3ydeex10c().s[1]++,require("cors"));const jwt=(cov_3ydeex10c().s[2]++,require('jsonwebtoken'));const Users=(cov_3ydeex10c().s[3]++,require("./controllers/user.controller.js"));const bcrypt=(cov_3ydeex10c().s[4]++,require('bcrypt'));const passport=(cov_3ydeex10c().s[5]++,require('passport'));const passportJWT=(cov_3ydeex10c().s[6]++,require('passport-jwt'));let ExtractJwt=(cov_3ydeex10c().s[7]++,passportJWT.ExtractJwt);let JwtStrategy=(cov_3ydeex10c().s[8]++,passportJWT.Strategy);let jwtOptions=(cov_3ydeex10c().s[9]++,{});cov_3ydeex10c().s[10]++;jwtOptions.jwtFromRequest=ExtractJwt.fromAuthHeaderAsBearerToken();cov_3ydeex10c().s[11]++;jwtOptions.secretOrKey='wowwow';let strategy=(cov_3ydeex10c().s[12]++,new JwtStrategy(jwtOptions,function(jwt_payload,next){cov_3ydeex10c().f[0]++;cov_3ydeex10c().s[13]++;console.log('payload received',jwt_payload);let user=(cov_3ydeex10c().s[14]++,Users.getUser({id:jwt_payload.id}));cov_3ydeex10c().s[15]++;if(user){cov_3ydeex10c().b[0][0]++;cov_3ydeex10c().s[16]++;next(null,user);}else{cov_3ydeex10c().b[0][1]++;cov_3ydeex10c().s[17]++;next(null,false);}}));// use the strategy
cov_3ydeex10c().s[18]++;passport.use(strategy);const app=(cov_3ydeex10c().s[19]++,express());var corsOptions=(cov_3ydeex10c().s[20]++,{origin:"http://localhost:8081"});cov_3ydeex10c().s[21]++;app.use(passport.initialize());cov_3ydeex10c().s[22]++;app.use(cors(corsOptions));// parse requests of content-type - application/json
cov_3ydeex10c().s[23]++;app.use(express.json());/* bodyParser.json() is deprecated */ // parse requests of content-type - application/x-www-form-urlencoded
cov_3ydeex10c().s[24]++;app.use(express.urlencoded({extended:true}));/* bodyParser.urlencoded() is deprecated */const db=(cov_3ydeex10c().s[25]++,require("./models"));cov_3ydeex10c().s[26]++;db.sequelize.sync();// // drop the table if it already exists
// db.sequelize.sync({ force: true }).then(() => {
//   console.log("Drop and re-sync db.");
// });
// simple route
// register route
cov_3ydeex10c().s[27]++;app.post('/register',function(req,res,next){cov_3ydeex10c().f[1]++;const{name,password}=(cov_3ydeex10c().s[28]++,req.body);const saltRounds=(cov_3ydeex10c().s[29]++,10);// bcrypt.hash(password, saltRounds, (err, hash) => {
//     if (err) return next(err);
//     password = hash;
//     next();
// });
cov_3ydeex10c().s[30]++;Users.createUser({name,password}).then(user=>{cov_3ydeex10c().f[2]++;cov_3ydeex10c().s[31]++;return res.json({user,msg:'account created successfully'});});});//login route
cov_3ydeex10c().s[32]++;app.post('/login',async function(req,res,next){cov_3ydeex10c().f[3]++;const{name,password}=(cov_3ydeex10c().s[33]++,req.body);cov_3ydeex10c().s[34]++;if((cov_3ydeex10c().b[2][0]++,name)&&(cov_3ydeex10c().b[2][1]++,password)){cov_3ydeex10c().b[1][0]++;let user=(cov_3ydeex10c().s[35]++,await Users.getUser({name:name}));cov_3ydeex10c().s[36]++;if(!user){cov_3ydeex10c().b[3][0]++;cov_3ydeex10c().s[37]++;res.status(401).json({message:'No such user found'});}else{cov_3ydeex10c().b[3][1]++;}// bcrypt.compare(password, hash, function (err, res) {
cov_3ydeex10c().s[38]++;if(user.password===hash){cov_3ydeex10c().b[4][0]++;// from now on we'll identify the user by the id and the id is the 
// only personalized value that goes into our token
let payload=(cov_3ydeex10c().s[39]++,{id:user.id});let token=(cov_3ydeex10c().s[40]++,jwt.sign(payload,jwtOptions.secretOrKey));cov_3ydeex10c().s[41]++;res.json({msg:'ok',token:token});}else{cov_3ydeex10c().b[4][1]++;cov_3ydeex10c().s[42]++;res.status(401).json({msg:'Password is incorrect'});}// });
}else{cov_3ydeex10c().b[1][1]++;}});// app.get('/protected', passport.authenticate('jwt', { session: false }), function (req, res) {
//     console.log(req.isAuthenticated());
//     res.json({ msg: 'Congrats! You are seeing this because you are authorized' });
// });
cov_3ydeex10c().s[43]++;require("./routes/tutorial.routes",passport.authenticate('jwt',{session:false}))(app);cov_3ydeex10c().s[44]++;require("./routes/user.routes")(app);cov_3ydeex10c().s[45]++;require("./routes/comment.routes",passport.authenticate('jwt',{session:false}))(app);// set port, listen for requests
const PORT=(cov_3ydeex10c().s[46]++,(cov_3ydeex10c().b[5][0]++,process.env.PORT)||(cov_3ydeex10c().b[5][1]++,3000));//const PORT = process.env.NODE_ENV = "test"
cov_3ydeex10c().s[47]++;app.listen(PORT,()=>{cov_3ydeex10c().f[4]++;cov_3ydeex10c().s[48]++;console.log(`Server is running on port ${PORT}.`);});cov_3ydeex10c().s[49]++;module.exports=app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImNvcnMiLCJqd3QiLCJVc2VycyIsImJjcnlwdCIsInBhc3Nwb3J0IiwicGFzc3BvcnRKV1QiLCJFeHRyYWN0Snd0IiwiSnd0U3RyYXRlZ3kiLCJTdHJhdGVneSIsImp3dE9wdGlvbnMiLCJqd3RGcm9tUmVxdWVzdCIsImZyb21BdXRoSGVhZGVyQXNCZWFyZXJUb2tlbiIsInNlY3JldE9yS2V5Iiwic3RyYXRlZ3kiLCJqd3RfcGF5bG9hZCIsIm5leHQiLCJjb25zb2xlIiwibG9nIiwidXNlciIsImdldFVzZXIiLCJpZCIsInVzZSIsImFwcCIsImNvcnNPcHRpb25zIiwib3JpZ2luIiwiaW5pdGlhbGl6ZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJkYiIsInNlcXVlbGl6ZSIsInN5bmMiLCJwb3N0IiwicmVxIiwicmVzIiwibmFtZSIsInBhc3N3b3JkIiwiYm9keSIsInNhbHRSb3VuZHMiLCJjcmVhdGVVc2VyIiwidGhlbiIsIm1zZyIsInN0YXR1cyIsIm1lc3NhZ2UiLCJoYXNoIiwicGF5bG9hZCIsInRva2VuIiwic2lnbiIsImF1dGhlbnRpY2F0ZSIsInNlc3Npb24iLCJQT1JUIiwicHJvY2VzcyIsImVudiIsImxpc3RlbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiIrbUxBZVk7eUZBZFosS0FBTUEsQ0FBQUEsT0FBTyx5QkFBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBVixDQUFiLENBQ0E7QUFDQSxLQUFNQyxDQUFBQSxJQUFJLHlCQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFWLENBQVYsQ0FDQSxLQUFNRSxDQUFBQSxHQUFHLHlCQUFHRixPQUFPLENBQUMsY0FBRCxDQUFWLENBQVQsQ0FDQSxLQUFNRyxDQUFBQSxLQUFLLHlCQUFHSCxPQUFPLENBQUMsa0NBQUQsQ0FBVixDQUFYLENBQ0EsS0FBTUksQ0FBQUEsTUFBTSx5QkFBR0osT0FBTyxDQUFDLFFB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Q0FBUCxDQUFzRjNCLEdBQXRGLEUsd0JBQ0F2QixPQUFPLENBQUMsc0JBQUQsQ0FBUCxDQUFnQ3VCLEdBQWhDLEUsd0JBQ0F2QixPQUFPLENBQUMseUJBQUQsQ0FBNEJLLFFBQVEsQ0FBQzRDLFlBQVQsQ0FBc0IsS0FBdEIsQ0FBNkIsQ0FBRUMsT0FBTyxDQUFFLEtBQVgsQ0FBN0IsQ0FBNUIsQ0FBUCxDQUFxRjNCLEdBQXJGLEVBR0E7QUFDQSxLQUFNNEIsQ0FBQUEsSUFBSSwwQkFBRywyQkFBQUMsT0FBTyxDQUFDQyxHQUFSLENBQVlGLElBQVosOEJBQW9CLElBQXBCLENBQUgsQ0FBVixDQUNBO3dCQUNBNUIsR0FBRyxDQUFDK0IsTUFBSixDQUFXSCxJQUFYLENBQWlCLElBQU0sZ0RBQ25CbEMsT0FBTyxDQUFDQyxHQUFSLENBQWEsNkJBQTRCaUMsSUFBSyxHQUE5QyxFQUNILENBRkQsRSx3QkFJQUksTUFBTSxDQUFDQyxPQUFQLENBQWlCakMsR0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyJcbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTtcbi8vIGNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKFwiYm9keS1wYXJzZXJcIik7IC8qIGRlcHJlY2F0ZWQgKi9cbmNvbnN0IGNvcnMgPSByZXF1aXJlKFwiY29yc1wiKTtcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuY29uc3QgVXNlcnMgPSByZXF1aXJlKFwiLi9jb250cm9sbGVycy91c2VyLmNvbnRyb2xsZXIuanNcIik7XG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcblxuY29uc3QgcGFzc3BvcnQgPSByZXF1aXJlKCdwYXNzcG9ydCcpO1xuY29uc3QgcGFzc3BvcnRKV1QgPSByZXF1aXJlKCdwYXNzcG9ydC1qd3QnKTtcblxubGV0IEV4dHJhY3RKd3QgPSBwYXNzcG9ydEpXVC5FeHRyYWN0Snd0O1xubGV0IEp3dFN0cmF0ZWd5ID0gcGFzc3BvcnRKV1QuU3RyYXRlZ3k7XG5cbmxldCBqd3RPcHRpb25zID0ge307XG5qd3RPcHRpb25zLmp3dEZyb21SZXF1ZXN0ID0gRXh0cmFjdEp3dC5mcm9tQXV0aEhlYWRlckFzQmVhcmVyVG9rZW4oKTtcbmp3dE9wdGlvbnMuc2VjcmV0T3JLZXkgPSAnd293d293JztcblxuXG5sZXQgc3RyYXRlZ3kgPSBuZXcgSnd0U3RyYXRlZ3koand0T3B0aW9ucywgZnVuY3Rpb24gKGp3dF9wYXlsb2FkLCBuZXh0KSB7XG4gICAgY29uc29sZS5sb2coJ3BheWxvYWQgcmVjZWl2ZWQnLCBqd3RfcGF5bG9hZCk7XG4gICAgbGV0IHVzZXIgPSBVc2Vycy5nZXRVc2VyKHsgaWQ6IGp3dF9wYXlsb2FkLmlkIH0pO1xuXG4gICAgaWYgKHVzZXIpIHtcbiAgICAgICAgbmV4dChudWxsLCB1c2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KG51bGwsIGZhbHNlKTtcbiAgICB9XG59KTtcbi8vIHVzZSB0aGUgc3RyYXRlZ3lcbnBhc3Nwb3J0LnVzZShzdHJhdGVneSk7XG5cbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcblxudmFyIGNvcnNPcHRpb25zID0ge1xuICAgIG9yaWdpbjogXCJodHRwOi8vbG9jYWxob3N0OjgwODFcIlxufTtcbmFwcC51c2UocGFzc3BvcnQuaW5pdGlhbGl6ZSgpKTtcblxuXG5hcHAudXNlKGNvcnMoY29yc09wdGlvbnMpKTtcblxuLy8gcGFyc2UgcmVxdWVzdHMgb2YgY29udGVudC10eXBlIC0gYXBwbGljYXRpb24vanNvblxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7ICAvKiBib2R5UGFyc2VyLmpzb24oKSBpcyBkZXByZWNhdGVkICovXG5cbi8vIHBhcnNlIHJlcXVlc3RzIG9mIGNvbnRlbnQtdHlwZSAtIGFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFxuYXBwLnVzZShleHByZXNzLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7ICAgLyogYm9keVBhcnNlci51cmxlbmNvZGVkKCkgaXMgZGVwcmVjYXRlZCAqL1xuXG5jb25zdCBkYiA9IHJlcXVpcmUoXCIuL21vZGVsc1wiKTtcblxuZGIuc2VxdWVsaXplLnN5bmMoKTtcbi8vIC8vIGRyb3AgdGhlIHRhYmxlIGlmIGl0IGFscmVhZHkgZXhpc3RzXG4vLyBkYi5zZXF1ZWxpemUuc3luYyh7IGZvcmNlOiB0cnVlIH0pLnRoZW4oKCkgPT4ge1xuLy8gICBjb25zb2xlLmxvZyhcIkRyb3AgYW5kIHJlLXN5bmMgZGIuXCIpO1xuLy8gfSk7XG5cbi8vIHNpbXBsZSByb3V0ZVxuLy8gcmVnaXN0ZXIgcm91dGVcbmFwcC5wb3N0KCcvcmVnaXN0ZXInLCBmdW5jdGlvbiAocmVxLCByZXMsIG5leHQpIHtcbiAgICBjb25zdCB7IG5hbWUsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCBzYWx0Um91bmRzID0gMTA7XG4gICAgLy8gYmNyeXB0Lmhhc2gocGFzc3dvcmQsIHNhbHRSb3VuZHMsIChlcnIsIGhhc2gpID0+IHtcbiAgICAvLyAgICAgaWYgKGVycikgcmV0dXJuIG5leHQoZXJyKTtcbiAgICAvLyAgICAgcGFzc3dvcmQgPSBoYXNoO1xuICAgIC8vICAgICBuZXh0KCk7XG4gICAgLy8gfSk7XG4gICAgVXNlcnMuY3JlYXRlVXNlcih7IG5hbWUsIHBhc3N3b3JkIH0pLnRoZW4odXNlciA9PlxuICAgICAgICByZXMuanNvbih7IHVzZXIsIG1zZzogJ2FjY291bnQgY3JlYXRlZCBzdWNjZXNzZnVsbHknIH0pXG4gICAgKTtcbn0pO1xuXG4vL2xvZ2luIHJvdXRlXG5hcHAucG9zdCgnL2xvZ2luJywgYXN5bmMgZnVuY3Rpb24gKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgY29uc3QgeyBuYW1lLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgaWYgKG5hbWUgJiYgcGFzc3dvcmQpIHtcbiAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2Vycy5nZXRVc2VyKHsgbmFtZTogbmFtZSB9KTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1lc3NhZ2U6ICdObyBzdWNoIHVzZXIgZm91bmQnIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCBoYXNoLCBmdW5jdGlvbiAoZXJyLCByZXMpIHtcbiAgICAgICAgaWYgKHVzZXIucGFzc3dvcmQgPT09IGhhc2gpIHtcbiAgICAgICAgICAgIC8vIGZyb20gbm93IG9uIHdlJ2xsIGlkZW50aWZ5IHRoZSB1c2VyIGJ5IHRoZSBpZCBhbmQgdGhlIGlkIGlzIHRoZSBcbiAgICAgICAgICAgIC8vIG9ubHkgcGVyc29uYWxpemVkIHZhbHVlIHRoYXQgZ29lcyBpbnRvIG91ciB0b2tlblxuICAgICAgICAgICAgbGV0IHBheWxvYWQgPSB7IGlkOiB1c2VyLmlkIH07XG4gICAgICAgICAgICBsZXQgdG9rZW4gPSBqd3Quc2lnbihwYXlsb2FkLCBqd3RPcHRpb25zLnNlY3JldE9yS2V5KTtcbiAgICAgICAgICAgIHJlcy5qc29uKHsgbXNnOiAnb2snLCB0b2tlbjogdG9rZW4gfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IG1zZzogJ1Bhc3N3b3JkIGlzIGluY29ycmVjdCcgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gfSk7XG5cbiAgICB9XG59KTtcbi8vIGFwcC5nZXQoJy9wcm90ZWN0ZWQnLCBwYXNzcG9ydC5hdXRoZW50aWNhdGUoJ2p3dCcsIHsgc2Vzc2lvbjogZmFsc2UgfSksIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuLy8gICAgIGNvbnNvbGUubG9nKHJlcS5pc0F1dGhlbnRpY2F0ZWQoKSk7XG4vLyAgICAgcmVzLmpzb24oeyBtc2c6ICdDb25ncmF0cyEgWW91IGFyZSBzZWVpbmcgdGhpcyBiZWNhdXNlIHlvdSBhcmUgYXV0aG9yaXplZCcgfSk7XG4vLyB9KTtcblxucmVxdWlyZShcIi4vcm91dGVzL3R1dG9yaWFsLnJvdXRlc1wiLCBwYXNzcG9ydC5hdXRoZW50aWNhdGUoJ2p3dCcsIHsgc2Vzc2lvbjogZmFsc2UgfSkpKGFwcCk7XG5yZXF1aXJlKFwiLi9yb3V0ZXMvdXNlci5yb3V0ZXNcIikoYXBwKTtcbnJlcXVpcmUoXCIuL3JvdXRlcy9jb21tZW50LnJvdXRlc1wiLCBwYXNzcG9ydC5hdXRoZW50aWNhdGUoJ2p3dCcsIHsgc2Vzc2lvbjogZmFsc2UgfSkpKGFwcCk7XG5cblxuLy8gc2V0IHBvcnQsIGxpc3RlbiBmb3IgcmVxdWVzdHNcbmNvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDMwMDA7XG4vL2NvbnN0IFBPUlQgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9IFwidGVzdFwiXG5hcHAubGlzdGVuKFBPUlQsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhgU2VydmVyIGlzIHJ1bm5pbmcgb24gcG9ydCAke1BPUlR9LmApO1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gYXBwO1xuIl19